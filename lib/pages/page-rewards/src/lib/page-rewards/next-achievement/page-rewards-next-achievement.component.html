<feature-prize-search #featurePrizeSearch />
<feature-coins
  #featureCoins
  (coinsUpdated)="featureCoins.loadNextPrize(featurePrizeSearch)"
/>
@if (featurePrizeSearch.nextPrize(); as nextPrize) {
  <div class="page-rewards-next-achievement">
    <div class="page-rewards-next-achievement__prize-header">
      <span class="page-rewards-next-achievement__prize-icon body-small">
        <fast-svg name="diamond" />
      </span>
      <div class="page-rewards-next-achievement__prize-name body-small" i18n>
        Next reward
      </div>
    </div>
    <div class="page-rewards-next-achievement__prize-name body-extra-small">
      {{ nextPrize.name }}
    </div>
    @defer (when nextPrize) {
      @if (featureRewardsList.highestReward() === undefined) {
        <page-common-on-init
          (onInit)="featureRewardsList.loadHighestReward()"
        />
      }
      <feature-rewards-list
        #featureRewardsList
        (highestRewardLoaded)="
          featureRewardsList.calculateRewardProgress(
            featureCoins,
            featurePrizeSearch,
            progressBar
          )
        "
      />
      <page-rewards-next-achievement-progress-bar
        #progressBar
        [nextPrizeRequiredPoints]="nextPrize.requiredPoints"
        [coins]="featureCoins.coins()"
      />
    }
  </div>
} @else {
  <a
    class="btn-secondary"
    [routerLink]="['./']"
    [fragment]="'settings'"
    [skipLocationChange]="true"
    i18n
    >set prize</a
  >
}
